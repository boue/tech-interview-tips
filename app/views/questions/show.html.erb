<% content_for :title do %><%= @question.title %><% end %>
<div class="row">
  <div class="small-12 large-12 columns panel">
  <%= render partial: "layouts/alerts" %>
    <% if current_user %>
      <%= render partial: "questions/logged" %>
    <% else %>
      <%= render partial: "questions/notlogged" %>
    <% end %>
    <span data-tooltip class="has-tip" title="Pageviews"><i class="fa fa-eye"></i>&nbsp;<%= @question.impressionist_count %></span><br><br>

    <h3><%= @question.title %>
      <%= render partial: "questions/share" %></h3>
    <hr>

    <p class="text-left">
      <% unless @question.tag_list.count < 1 %>
        <span class="label"><%= raw @question.tag_list.map { |t| link_to t, tag_path(t) }.join('</span> <span class="label">') %></span>
      <% end %>
    </p>

    <% if current_user %>
      <% if current_user.id == @question.user.id %>
      <p class="text-right"><%= link_to "edit", edit_question_path(@question), class: "button [tiny small large]" %>
        <%= link_to "delete", question_path(@question), method: :delete, class: "button [tiny small large]" %></p>
      <% end %>
    <% end %>

     <%= render partial: "questions/gravatar", locals: { question: @question } %>
  </div>
</div>

<div class="row">
  <div class="small-12 large-12 columns panel">
    <% if current_user %>
      <h3>Answer Question</h3>
        <%= render partial: "answers/new", locals: { question: @question } %>
    <% else %>
      <h3>Please log in to answer!</h3>
    <% end %>
  </div>
</div>

<% @question.answers.each do |answer| %>
  <div class="row">
    <div class="small-12 large-12 columns panel clearfix">

        <% if current_user %>
        <span id="<%= answer.id %>" data-tooltip class="has-tip" title="Give this answer a thumbs-up."><%= link_to kudos_path(question_id: @question.id, answer_id: answer.id), class: "fa fa-thumbs-up answer-thumbs-up", :remote => true, method: :post do %><% end %>&nbsp;<span class="answer-vote"><%= answer.kudos.count %></span></span>
        <% else %>
          <span data-tooltip class="has-tip" title="Sign-in to give this question a thumbs-up."><i class="fa fa-thumbs-up grey-out"></i>&nbsp;<%= answer.kudos.count %></span>
        <% end %>

    <%= render partial: "answers/show", locals: { answer: answer } %>
      <% if current_user %>
    <%= render partial: "comments/new", locals: { question: @question, answer: answer } %>
      <% end %>
    <%= render partial: "comments/show", locals: { answer: answer } %>
    </div>
  </div>
<% end %>

<script src="/assets/question.js"></script>

